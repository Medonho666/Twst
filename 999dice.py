import marshal,zlib,base64
exec(base64.b64decode("aW1wb3J0IHJlcXVlc3RzLGpzb24sdGltZSxzeXMscmFuZG9tLG9zLGFyZ3BhcnNlCmltcG9ydCBjb2xvcmFtYQpmcm9tIGNvbG9yYW1hIGltcG9ydCBGb3JlLCBCYWNrLCBTdHlsZQpmcm9tIHJhbmRvbSBpbXBvcnQgcmFuZGludApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpjb2xvcmFtYS5pbml0KGF1dG9yZXNldD1UcnVlKQoKCgpwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0nOTk5IERpY2UgQm90IHwgVGhpcyBJcyBHYW1ibGluZyBCb3QgUGxhc2UgVGFrZSBPd24gWW91ciBSaXNrJykKcGFyc2VyLmFkZF9hcmd1bWVudCgKICAgICctYycsJy0tYmV0c2V0JywKICAgIGRlZmF1bHQ9MCwKICAgIGhlbHA9J0VudGVyIFlvdXIgQmV0c2V0IE51bWJlciAoZGVmYXVsdDogMCknCikKbXlfbmFtZXNwYWNlID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQoKCgoKCndpdGggb3BlbignY29uZmlnLmpzb24nLCAncicpIGFzIG15ZmlsZToKICAgICAgZGF0YT1teWZpbGUucmVhZCgpCiMgcGFyc2UgZmlsZQpvYmogPSBqc29uLmxvYWRzKGRhdGEpCgoKcHJpbnQgKFN0eWxlLk5PUk1BTCtGb3JlLkdSRUVOKyJcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuIitTdHlsZS5CUklHSFQrRm9yZS5HUkVFTisiQXV0aG9yIEJ5ICAiK1N0eWxlLkRJTStGb3JlLldISVRFKyI6ICIrU3R5bGUuUkVTRVRfQUxMKyJLRUxWSU4gT3duZXIgdC5tZS9kdW5pYWpha2VcbiIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIkNoYW5uZWwgWW91dHViZSAiK1N0eWxlLk5PUk1BTCtGb3JlLldISVRFKyI6IitTdHlsZS5SRVNFVF9BTEwrIiBDYXJpIE1vbmV5IitTdHlsZS5CUklHSFQrRm9yZS5HUkVFTisiXG45OTkgRGljZSBCb3QiK1N0eWxlLk5PUk1BTCtGb3JlLldISVRFKyIgfCAiK1N0eWxlLkJSSUdIVCtGb3JlLllFTExPVysiTG9zZSBTdHJlYWsgIitTdHlsZS5OT1JNQUwrRm9yZS5XSElURSsifCIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIiBXaW4gU3RyZWFrXG4iK1N0eWxlLkJSSUdIVCtGb3JlLldISVRFKyJzdXBwb3J0IGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9rbHZpbm5uLzk5OVxuIitTdHlsZS5CUklHSFQrRm9yZS5HUkVFTisiRG9uYXRlICIrU3R5bGUuTk9STUFMK0ZvcmUuV0hJVEUrIjoiK1N0eWxlLkJSSUdIVCtGb3JlLkdSRUVOKyIgQlRDICIrU3R5bGUuUkVTRVRfQUxMKyIxN0g0dEF6Y2ZpUDhKRW1ZUTJCUTRnUWZWZlRtTmpwY2I4XG4iK1N0eWxlLkJSSUdIVCtGb3JlLkdSRUVOKyIgICAgICAgICBMVEMgIitTdHlsZS5SRVNFVF9BTEwrIkxSWXRYZ0dWRDM4dEZISzhWUlExOFJNSlR2VWtTS1ZoZ3dcbiIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIiAgICAgICAgIERvZ2UgIitTdHlsZS5SRVNFVF9BTEwrIkRSeFpqRDNQcmZmb1JpMUZmc2p4cWFoenJndXppVGVDNlRcblxuIitTdHlsZS5OT1JNQUwrRm9yZS5HUkVFTisiXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiIpCgpoaWphdSA9IFN0eWxlLkJSSUdIVCtGb3JlLkdSRUVOCgpyZXMgPSBTdHlsZS5SRVNFVF9BTEwKYWJ1MiA9IFN0eWxlLk5PUk1BTCtGb3JlLldISVRFCnVuZ3UgPSBTdHlsZS5OT1JNQUwrRm9yZS5NQUdFTlRBCmhpamF1MiA9IFN0eWxlLk5PUk1BTCtGb3JlLkdSRUVOCnJlZDIgPSBTdHlsZS5OT1JNQUwrRm9yZS5ZRUxMT1cKcmVkID0gU3R5bGUuQlJJR0hUK0ZvcmUuWUVMTE9XCmMgPSByZXF1ZXN0cy5zZXNzaW9uKCkKCnVybCA9ICJodHRwczovL3d3dy45OTlkb2dlLmNvbS9hcGkvd2ViLmFzcHgiCnVhID0gewogIk9yaWdpbiI6ICJmaWxlOi8vIiwKICJ1c2VyLWFnZW50Ijogb2JqWyJVc2VyLUFnZW50Il0sCiAiQ29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIsCiAiQWNjZXB0IjogIiovKiIsCiAiQWNjZXB0LUxhbmd1YWdlIjogImlkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43IiwKICJYLVJlcXVlc3RlZC1XaXRoIjogImNvbS5yZWxhbmQucmVsYW5kaWNlYm90Igp9CgpkZWYga29udmVydChwZXJzZW4sdGFydWhhbik6CiAgICBnbG9iYWwgaGlnaAogICAgZ2xvYmFsIGxvdwogICAgYyA9IHN0cig5OTk5OTkgKiBmbG9hdChwZXJzZW4pIC8gMTAwKQogICAgaWYgdGFydWhhbiA9PSAiSGkiIG9yIHRhcnVoYW4gPT0gImhpIiBvciB0YXJ1aGFuID09ICJISSI6CiAgICAgICBuID0gc3RyKGMuc3BsaXQoIi4iKVsxXSkKICAgICAgIHBhbmdrYXQgPSA2IC0gbGVuKG4pCiAgICAgICBsb3cgPSBpbnQoaW50KG4pICogKDEwICoqIHBhbmdrYXQpKQogICAgICAgaGlnaCA9IDk5OTk5OQogICAgaWYgdGFydWhhbiA9PSAiTG8iIG9yIHRhcnVoYW4gPT0gIkxPVyIgb3IgdGFydWhhbiA9PSAibG93IiBvciB0YXJ1aGFuID09ICJMb3ciIG9yIHRhcnVoYW4gPT0gIkxPIjoKICAgICAgIGxvdyA9IDAKICAgICAgIGhpZ2ggPSBpbnQoYy5zcGxpdCgiLiIpWzBdKQoKCmRlZiByZXYobnVtKToKICAgIGlmIChsZW4obnVtKSA8IDgpOgogICAgICAgIHBhbmphbmdfbm9sID0gaW50KDggLSBsZW4obnVtKSkKICAgICAgICBudW0gPSAoKHBhbmphbmdfbm9sKiIwIikrc3RyKG51bSkpCiAgICAgICAgcmVzdWx0ID0gKCIwLiIrbnVtKQogICAgaWYgKGxlbihudW0pID09IDgpOgogICAgICAgIHBhbmphbmdfbm9sID0gaW50KDggLSBsZW4obnVtKSkKICAgICAgICBudW0gPSAoKHBhbmphbmdfbm9sKiIwIikrc3RyKG51bSkpCiAgICAgICAgcmVzdWx0ID0gKCIwLiIrbnVtKQogICAgZWxzZToKICAgICAgICBsZW5fbnVtID0gbGVuKG51bSkKICAgICAgICBlbmQgPSBudW1bLTg6XQogICAgICAgIGZpcnN0ID0gbnVtWzpsZW5fbnVtLThdCiAgICAgICAgcmVzdWx0ID0gKGZpcnN0KyIuIitlbmQpCiAgICByZXR1cm4gKHJlc3VsdCkKCgoKZGVmIGRpY2Uod3MsbHMpOgogICBpZiBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJBdXRvIiBvciBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJhdXRvIiBvciBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJBVVRPIjoKICAgICAgdXJ1dCA9IDAKICAgICAganVtbGFodWxhbmc9IDAKICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAganVtbGFodWxhbmcrPTEKICAgICAgICAgdHJ5OgogICAgICAgICAgICAgcGVzYW4gPSBvYmpbIkNvbmZpZyJdW2p1bWxhaHVsYW5nXVsiTmFtZSBCZXQgU2V0Il0KICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgYnJlYWsKICAgZWxzZToKICAgICAgdXJ1dCA9IGludChteV9uYW1lc3BhY2UuYmV0c2V0KQoKICAgc2xwID0gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkludGVydmFsIl0pIC8gMTAwMAogICBsaW1pdF9hID0gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJlc2V0IElmIFdpbiJdKSAtIDEKICAgcGF5aW4gPSBpbnQoZmxvYXQob2JqWyJDb25maWciXVt1cnV0XVsiQmFzZSBCZXQiXSkqKDEwICoqIDgpKQogICBrb252ZXJ0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkNoYW5jZSJdLG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJCZXQiXSkKICAgYW1vdW50ID0gcGF5aW4KICAgZGF0YSA9IHsKICAgICAgImEiOiAiUGxhY2VCZXQiLAogICAgICAicyI6IGpzWyJTZXNzaW9uQ29va2llIl0sCiAgICAgICJQYXlJbiI6IGFtb3VudCwKICAgICAgIkxvdyI6IGxvdywKICAgICAgIkhpZ2giOiBoaWdoLAogICAgICAiQ2xpZW50U2VlZCI6IHJhbmRpbnQoMCw5OTk5OTkpLAogICAgICAiQ3VycmVuY3kiOiAiZG9nZSIsCiAgICAgICJQcm90b2NvbFZlcnNpb24iOiAiMiIKICAgfQogICB0cnk6CiAgICAgcjEgPSBjLnBvc3QodXJsLGhlYWRlcnM9dWEsZGF0YT1kYXRhKQogICAgIGpzbiA9IGpzb24ubG9hZHMocjEudGV4dCkKICAgICBqdW1ibCA9IGpzblsiU3RhcnRpbmdCYWxhbmNlIl0gKyBpbnQoanNuWyJQYXlPdXQiXSkgLSBpbnQoYW1vdW50KQogICAgIGp1bSA9IGludChqc25bIlBheU91dCJdKSAtIGludChhbW91bnQpCiAgICAgcHJvZiA9IChmbG9hdChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdICsgaW50KGpzblsiUGF5T3V0Il0pIC0gaW50KGFtb3VudCkgLSBqdW1ibCkvKDEwICoqIDgpKQogICAgIHByaW50IChoaWphdSsiXG5cblxuU3RhcnRpbmcgQmFsYW5jZSIscmVzK3N0cigoZmxvYXQoaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkpLygxMCAqKiA4KSkpKQogICAgIHByaW50ICgiQW5kYSBNZW5nZ3VuYWthbiBCZXRTZXQgS2UgIitvYmpbIkNvbmZpZyJdW3VydXRdWyJOYW1lIEJldCBTZXQiXSkKICAgICBuID0gMAogICAgIGJ1cnN0ID0gRmFsc2UKICAgICBzdGF0c19yb2xlYmV0X2xvc2UgPSBGYWxzZQogICAgIHN0YXRzX3JvbGViZXRfd2luID0gRmFsc2UKICAgICBtZW5pdCA9IGRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCclTScpCiAgICAgbWVuaXQgPSBpbnQobWVuaXQpICsgaW50KG9ialsiSW50ZXJ2YWwiXSkKICAgICBub193aW4gPSAwCiAgICAgbm9fbG9zZSA9IDAKICAgICB0b3RhbF93aW49MAogICAgIHRvdGFsX2xvc2U9MAogICAgIG5vX3JvbGViZXQgPSAwCiAgICAgcm9sZWJldD0iSGkiCiAgICAgcmVzZXRfaWZfcHJvZml0ID0gb2JqWyJDb25maWciXVt1cnV0XVsiUmVzZXQgSWYgUHJvZml0Il0KICAgICB0b3RfaWZfcHJvZml0ID0gb2JqWyJDb25maWciXVt1cnV0XVsiUmVzZXQgSWYgUHJvZml0Il0KICAgICB3aGlsZSBUcnVlOgogICAgICAgIGlmIHJlc2V0X2lmX3Byb2ZpdCA9PSAiT0ZGIiBvciByZXNldF9pZl9wcm9maXQgPT0gIk9mZiIgb3IgcmVzZXRfaWZfcHJvZml0ID09ICJvZmYiOgogICAgICAgICAgIHN0YXRzX2lmX3Byb2ZpdCA9IEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICBzdGF0c19pZl9wcm9maXQgPSBUcnVlCiAgICAgICAgaWYgb2JqWyJDb25maWciXVt1cnV0XVsiTWF4IEJldCJdID09ICJPRkYiIG9yIG9ialsiQ29uZmlnIl1bdXJ1dF1bIk1heCBCZXQiXSA9PSAib2ZmIiBvciBvYmpbIkNvbmZpZyJdW3VydXRdWyJNYXggQmV0Il0gPT0gIk9mZiI6CiAgICAgICAgICAgIHN5cy5zdGRvdXQud3JpdGUoIiIpCiAgICAgICAgZWxzZToKICAgICAgICAgICBpZiBhbW91bnQgPiBpbnQoZmxvYXQob2JqWyJDb25maWciXVt1cnV0XVsiTWF4IEJldCJdKSooMTAgKiogOCkpOgogICAgICAgICAgICAgICBhbW91bnQgPSBwYXlpbgogICAgICAgIGlmIG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJUb2dnbGUiXSA9PSAiT24iIG9yIG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJUb2dnbGUiXSA9PSAiT04iIG9yIG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJUb2dnbGUiXSA9PSAib24iOgogICAgICAgICAgICBub19yb2xlYmV0ICs9MQogICAgICAgICAgICBpZiBzdGF0c19yb2xlYmV0X3dpbiBpcyBUcnVlOgogICAgICAgICAgICAgICBpZiBub19yb2xlYmV0ID4gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJJZiBXaW4iXSkgLSAxOgogICAgICAgICAgICAgICAgICByb2xlYmV0ID0gIkxvIgogICAgICAgICAgICAgICBpZiBub19yb2xlYmV0ID4gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJJZiBXaW4iXSkgKiAyIC0gMToKICAgICAgICAgICAgICAgICAgcm9sZWJldCA9ICJIaSIKICAgICAgICAgICAgICAgICAgbm9fcm9sZWJldCA9IDAKICAgICAgICAgICAgaWYgc3RhdHNfcm9sZWJldF9sb3NlIGlzIFRydWU6CiAgICAgICAgICAgICAgIGlmIG5vX3JvbGViZXQgPiBpbnQob2JqWyJDb25maWciXVt1cnV0XVsiQmV0Il1bIkhpIC8gTG93Il1bIklmIExvc2UiXSkgLTEgOgogICAgICAgICAgICAgICAgICByb2xlYmV0ID0gIkxvIgogICAgICAgICAgICAgICBpZiBub19yb2xlYmV0ID4gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJJZiBMb3NlIl0pICogMiAtIDE6CiAgICAgICAgICAgICAgICAgIHJvbGViZXQgPSAiSGkiCiAgICAgICAgICAgICAgICAgIG5vX3JvbGViZXQgPSAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcm9sZWJldCA9IG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJCZXQiXQogICAgICAgIGlmIG15X25hbWVzcGFjZS5iZXRzZXQgPT0gIkF1dG8iIG9yIG15X25hbWVzcGFjZS5iZXRzZXQgPT0gIkFVVE8iIG9yIG15X25hbWVzcGFjZS5iZXRzZXQgPT0gImF1dG8iOgogICAgICAgICAgd2FrdHUgPSBkYXRldGltZS5ub3coKS5zdHJmdGltZSgnJU0nKQogICAgICAgICAgaWYgaW50KHdha3R1KSA+IGludChtZW5pdCAtIDEpOgogICAgICAgICAgICAgbWVuaXQgPSBpbnQobWVuaXQpICsgaW50KG9ialsiSW50ZXJ2YWwiXSkKICAgICAgICAgICAgIHVydXQgKz0xCiAgICAgICAgICAgICBpZiB1cnV0ID09IGp1bWxhaHVsYW5nOgogICAgICAgICAgICAgICAgdXJ1dCA9IDAKICAgICAgICAgICAgIHByaW50ICgiQ2hhbmdlIEJldCBTZXQgIitvYmpbIkNvbmZpZyJdW3VydXRdWyJOYW1lIEJldCBTZXQiXSsiICAgICAgICAgICAgICAgICAgICAgICAgICAgIikKICAgICAgICAgICAgIHNscCA9IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJJbnRlcnZhbCJdKSAvIDEwMDAKICAgICAgICAgICAgIGxpbWl0X2EgPSBpbnQob2JqWyJDb25maWciXVt1cnV0XVsiUmVzZXQgSWYgV2luIl0pIC0gMQogICAgICAgICAgICAgcGF5aW4gPSBpbnQoZmxvYXQob2JqWyJDb25maWciXVt1cnV0XVsiQmFzZSBCZXQiXSkqKDEwICoqIDgpKQogICAgICAgICAgICAgYW1vdW50ID0gcGF5aW4KCiAgICAgICAgZWxzZToKICAgICAgICAgIHVydXQgPSBpbnQobXlfbmFtZXNwYWNlLmJldHNldCkKCiAgICAgICAgaWYgb2JqWyJDb25maWciXVt1cnV0XVsiUmFuZG9tIENoYW5jZSJdWyJUb2dnbGUiXSA9PSAiT04iIG9yIG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJhbmRvbSBDaGFuY2UiXVsiVG9nZ2xlIl0gPT0gIk9uIiBvciBvYmpbIkNvbmZpZyJdW3VydXRdWyJSYW5kb20gQ2hhbmNlIl1bIlRvZ2dsZSJdID09ICJvbiI6CiAgICAgICAgICAgaGFzaWxfY2hhbmNlID0gcm91bmQocmFuZG9tLnVuaWZvcm0oZmxvYXQob2JqWyJDb25maWciXVt1cnV0XVsiUmFuZG9tIENoYW5jZSJdWyJNaW4iXSksZmxvYXQob2JqWyJDb25maWciXVt1cnV0XVsiUmFuZG9tIENoYW5jZSJdWyJNYXgiXSkpLDIpCiAgICAgICAgICAgY29rID0gbGVuKHN0cihoYXNpbF9jaGFuY2UpKQogICAgICAgICAgIGlmIGNvayA9PSAzOgogICAgICAgICAgICAgIHN5cy5zdGRvdXQud3JpdGUoIlxyIitzdHIoaGFzaWxfY2hhbmNlKSsiICAgIikKICAgICAgICAgICBpZiBjb2sgPT0gNDoKICAgICAgICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKCJcciIrc3RyKGhhc2lsX2NoYW5jZSkrIiAgIikKICAgICAgICAgICBpZiBjb2sgPT0gNToKICAgICAgICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKCJcciIrc3RyKGhhc2lsX2NoYW5jZSkrIiAiKQogICAgICAgICAgIGtvbnZlcnQoaGFzaWxfY2hhbmNlLHN0cihyb2xlYmV0KSkKICAgICAgICBlbHNlOgogICAgICAgICAgIGtvbnZlcnQob2JqWyJDb25maWciXVt1cnV0XVsiQ2hhbmNlIl0sc3RyKHJvbGViZXQpKQoKICAgICAgICB0aW1lLnNsZWVwKGZsb2F0KHNscCkpCiAgICAgICAgYW1vdW50ID0gaW50KGFtb3VudCkKICAgICAgICBuKz0xCiAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICJhIjogIlBsYWNlQmV0IiwKICAgICAgICAgICJzIjoganNbIlNlc3Npb25Db29raWUiXSwKICAgICAgICAgICJQYXlJbiI6IGFtb3VudCwKICAgICAgICAgICJMb3ciOiBsb3csCiAgICAgICAgICAiSGlnaCI6IGhpZ2gsCiAgICAgICAgICAiQ2xpZW50U2VlZCI6IHJhbmRpbnQoMCw5OTk5OTkpLAogICAgICAgICAgIkN1cnJlbmN5IjogImRvZ2UiLAogICAgICAgICAgIlByb3RvY29sVmVyc2lvbiI6ICIyIgogICAgICAgIH0KICAgICAgICBpZiBwcm9mID4gZmxvYXQob2JqWyJUYXJnZXQgUHJvZml0Il0pOgogICAgICAgICAgIHByaW50IChoaWphdSsiXG5ZYXkuISBcblByb2ZpdCBNZW5jYXBhaSBUYXJnZXQuLi4uLiFcbiIraGlqYXUrIlByb2ZpdCAiK3JlcytzdHIocHJvZikpCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgWW91IHdpbiAiK3N0cihwcm9mKSkKICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgVG90YWwgQmFsYW5jZSAiK3N0cihmbG9hdChpbnQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSkgKyBpbnQoanVtKSkvKDEwICoqIDgpKSkKICAgICAgICAgICBzeXMuZXhpdCgpCiAgICAgICAgcjEgPSBjLnBvc3QodXJsLGhlYWRlcnM9dWEsZGF0YT1kYXRhKQogICAgICAgIGpzbiA9IGpzb24ubG9hZHMocjEudGV4dCkKICAgICAgICBwcm9mID0gKGZsb2F0KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0gKyBpbnQoanNuWyJQYXlPdXQiXSkgLSBpbnQoYW1vdW50KSAtIGp1bWJsKS8oMTAgKiogOCkpCiAgICAgICAganVtID0gaW50KGpzblsiUGF5T3V0Il0pIC0gaW50KGFtb3VudCkKICAgICAgICBpZiBqc25bIlN0YXJ0aW5nQmFsYW5jZSJdID4gd3M6CiAgICAgICAgICAgcHJpbnQgKHVuZ3UrIlsiK3JlcytzdHIocm9sZWJldCkrdW5ndSsiXSAiK2hpamF1MitzdHIoZmxvYXQoYW1vdW50KS8oMTAgKiogOCkpLHJlcytzdHIoZmxvYXQoaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkpLygxMCAqKiA4KSksaGlqYXUyKyJQcm9maXQiLHJlcytzdHIocHJvZikpCiAgICAgICAgICAgcHJpbnQgKGhpamF1KyJZYXkuIVxuQmFsYW5jZSBTdWRhaCBNZW1lbnVoaSBUYXJnZXQuLi4uLiEiKQogICAgICAgICAgIG9zLnN5c3RlbSgidGVybXV4LXRvYXN0IFRhcmdldCBXaW4gU3VkYWggVGVyY2FwYWkiKQogICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgICAgICAgICBvcy5zeXN0ZW0oInRlcm11eC10b2FzdCBUb3RhbCBCYWxhbmNlICIrc3RyKGZsb2F0KGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pKS8oMTAgKiogOCkpKQogICAgICAgICAgIHN5cy5leGl0KCkKICAgICAgICBpZiBqc25bIlN0YXJ0aW5nQmFsYW5jZSJdIDwgbHM6CiAgICAgICAgICAgcHJpbnQgKHVuZ3UrIlsiK3JlcytzdHIocm9sZWJldCkrdW5ndSsiXSIrcmVkMisiLSIrc3RyKGZsb2F0KGFtb3VudCkvKDEwICoqIDgpKSxyZXMrc3RyKChmbG9hdChpbnQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSkgKyBpbnQoanVtKSkvKDEwICoqIDgpKSkscmVkMisiTG9zZSAiLHJlcytzdHIocHJvZikpCiAgICAgICAgICAgcHJpbnQgKFN0eWxlLkJSSUdIVCtGb3JlLllFTExPVysiTG9zZSBUYXJnZXQuLi4uISIpCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgTG9zZSBUYXJnZXQgIikKICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgVG90YWwgQmFsYW5jZSAiK3N0cihmbG9hdChpbnQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSkgKyBpbnQoanVtKSkvKDEwICoqIDgpKSkKICAgICAgICAgICBzeXMuZXhpdCgpCiAgICAgICAgaWYganNuWyJQYXlPdXQiXSBpcyBub3QgMDoKICAgICAgICAgICBub193aW4gKz0xCiAgICAgICAgICAgbm9fbG9zZSA9IDAKICAgICAgICAgICBiYWwgPSBpbnQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSkgKyBpbnQoanVtKQogICAgICAgICAgIGlmIHByb2YgPiAwOgogICAgICAgICAgICAgcHJpbnQgKHVuZ3UrIlsiK3JlcytzdHIocm9sZWJldCkrdW5ndSsiXSAiK2hpamF1MitzdHIocmV2KHN0cihhbW91bnQpKSkscmVzK3N0cihyZXYoc3RyKGJhbCkpKSxoaWphdTIrIlByb2ZpdCIscmVzK3N0cihwcm9mKSkKICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgcHJpbnQgKHVuZ3UrIlsiK3JlcytzdHIocm9sZWJldCkrdW5ndSsiXSAiK2hpamF1MitzdHIocmV2KHN0cihhbW91bnQpKSkscmVzK3N0cihyZXYoc3RyKGJhbCkpKSxyZWQyKyJMb3NlICIscmVzK3N0cihwcm9mKSkKICAgICAgICAgICBhbW91bnQgPSBpbnQoYW1vdW50KSAqIGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIklmIFdpbiJdKQoKICAgICAgICBlbHNlOgogICAgICAgICAgIG5vX3dpbiA9IDAKICAgICAgICAgICBub19sb3NlICs9MQogICAgICAgICAgIGkgPSAwCiAgICAgICAgICAgYnVyc3QgPSBUcnVlCiAgICAgICAgICAgYmFsID0gaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkKICAgICAgICAgICBpZiBwcm9mID4gMDoKICAgICAgICAgICAgIHByaW50ICh1bmd1KyJbIityZXMrc3RyKHJvbGViZXQpK3VuZ3UrIl0iK3JlZDIrIi0iK3N0cihyZXYoc3RyKGFtb3VudCkpKSxyZXMrc3RyKHJldihzdHIoYmFsKSkpLGhpamF1MisiUHJvZml0IixyZXMrc3RyKHByb2YpKQogICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICBwcmludCAodW5ndSsiWyIrcmVzK3N0cihyb2xlYmV0KSt1bmd1KyJdIityZWQyKyItIitzdHIocmV2KHN0cihhbW91bnQpKSkscmVzK3N0cihyZXYoc3RyKGJhbCkpKSxyZWQyKyJMb3NlICIscmVzK3N0cihwcm9mKSkKICAgICAgICAgICBhbW91bnQgPSBpbnQoYW1vdW50KSAqIGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIklmIExvc2UiXSkKICAgICAgICBpZiBzdGF0c19pZl9wcm9maXQgaXMgVHJ1ZToKICAgICAgICAgICAgaWYgcHJvZiA+IGZsb2F0KHJlc2V0X2lmX3Byb2ZpdCk6CiAgICAgICAgICAgICAgIGFtb3VudCA9IHBheWluCiAgICAgICAgICAgICAgIHJlc2V0X2lmX3Byb2ZpdCA9IGZsb2F0KHByb2YpK2Zsb2F0KHRvdF9pZl9wcm9maXQpCgogICAgICAgIGlmIGJ1cnN0IGlzIFRydWU6CiAgICAgICAgICAgaSs9MQogICAgICAgICAgIGlmIGkgPiBsaW1pdF9hOgogICAgICAgICAgICAgaSA9IDAKICAgICAgICAgICAgIGJ1cnN0ID0gRmFsc2UKICAgICAgICBlbHNlOgogICAgICAgICAgIGlmIG4gPiBsaW1pdF9hOgogICAgICAgICAgICAgbiA9IDAKICAgICAgICAgICAgIGFtb3VudCA9IHBheWluCgogICAgICAgIGlmIG5vX3dpbiA+IHRvdGFsX3dpbjoKICAgICAgICAgICBzdGF0c19yb2xlYmV0X3dpbiA9IFRydWUKICAgICAgICAgICBzdGF0c19yb2xlYmV0X2xvc2UgPSBGYWxzZQogICAgICAgICAgIHRvdGFsX3dpbiArPTEKICAgICAgICBpZiBub19sb3NlID4gdG90YWxfbG9zZToKICAgICAgICAgICBzdGF0c19yb2xlYmV0X2xvc2UgPSBUcnVlCiAgICAgICAgICAgc3RhdHNfcm9sZWJldF93aW4gPSBGYWxzZQogICAgICAgICAgIHRvdGFsX2xvc2UgKz0xCiAgICAgICAgc3lzLnN0ZG91dC53cml0ZShoaWphdSsiICAgICAgICBXaW4gU3RyZWFrICIrcmVzK3N0cih0b3RhbF93aW4pK3JlZCsiIExvc2UgU3RyZWFrICIrcmVzK3N0cih0b3RhbF9sb3NlKSsiXHIiKQogICAgICAgIGlmIG9ialsiQXV0byBXZCJdWyJUb2dnbGUiXSA9PSAiT24iIG9yIG9ialsiQXV0byBXZCJdWyJUb2dnbGUiXSA9PSAiT04iIG9yIG9ialsiQXV0byBXZCJdWyJUb2dnbGUiXSA9PSAib24iOgogICAgICAgICAgIGlmIGZsb2F0KHJldihzdHIoYmFsKSkpID4gZmxvYXQob2JqWyJBdXRvIFdkIl1bIklmIEJhbGFuY2UiXSk6CiAgICAgICAgICAgICAgd2QgPSB7CiAgICAgICAgICAgICAgICAiYSI6ICJXaXRoZHJhdyIsCiAgICAgICAgICAgICAgICAicyI6IGpzWyJTZXNzaW9uQ29va2llIl0sCiAgICAgICAgICAgICAgICAiQW1vdW50IjogaW50KGZsb2F0KG9ialsiQXV0byBXZCJdWyJBbW91bnQiXSkqKDEwICoqIDgpKSwKICAgICAgICAgICAgICAgICJBZGRyZXNzIjogb2JqWyJBdXRvIFdkIl1bIldhbGxldCBBZGRyZXNzIl0sCiAgICAgICAgICAgICAgICAiVG90cCI6ICIiLAogICAgICAgICAgICAgICAgIkN1cnJlbmN5IjogImRvZ2UiCgogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByMSA9IGMucG9zdCh1cmwsaGVhZGVycz11YSxkYXRhPXdkKQogICAgICAgICAgICAgIHdpdGhkcmF3ID0ganNvbi5sb2FkcyhyMS50ZXh0KQogICAgICAgICAgICAgIHByaW50ICgiIikKICAgICAgICAgICAgICBwcmludCAoIldpdGhkcmF3ICIrc3RyKHJldihzdHIod2l0aGRyYXdbIlBlbmRpbmciXSkpKSkKICAgICAgICAgICAgICB3aXRoIG9wZW4oImhpc3RvcnkubG9nIiwiYSsiKSBhcyBmOgogICAgICAgICAgICAgICAgICBmLndyaXRlKCJXaXRoZHJhdyAiK3N0cihyZXYoc3RyKHdpdGhkcmF3WyJQZW5kaW5nIl0pKSkrIlxuIikKICAgICAgICAgICAgICBzeXMuZXhpdCgpCgoKCiAgIGV4Y2VwdDoKICAgICAgIHByaW50ICgiIikKICAgICAgIG9zLnN5c3RlbSgidGVybXV4LXRvYXN0IEJldHRpbmcgU3RvcCIpCiAgICAgICB0cnk6CiAgICAgICAgICB3aXRoIG9wZW4oImhpc3RvcnkubG9nIiwiYSsiKSBhcyBmOgogICAgICAgICAgICAgIGYud3JpdGUoIlsiK2RhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCclWS8lbS8lZCAlSDolTTolUycpKyJdIFdpbiBTdHJlYWsgIitzdHIodG90YWxfd2luKSsiIExvc2UgU3RyZWFrICIrc3RyKHRvdGFsX2xvc2UpKyIgfCBCYWxhbmNlICIrc3RyKGZsb2F0KGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pKS8oMTAgKiogOCkpKyIgUHJvZml0ICIrc3RyKHByb2YpKyJcbiIpCiAgICAgICBleGNlcHQ6CiAgICAgICAgICBwcmludCAocmVkMisiQmFsYW5jZSBOb3QgRW5vdWdoIikKICAgICAgIHN5cy5leGl0KCkKciA9IGMuZ2V0KHVybCxoZWFkZXJzPXVhLGRhdGE9eyJhIjogIkxvZ2luIiwiS2V5IjogIjdlYzdmOGEyYzk3MjRiMmNiYjhlZDc1ZTcyYjQ3ZWU5IiwiVXNlcm5hbWUiOiBvYmpbIkFjY291bnQiXVsiVXNlcm5hbWUiXSwiUGFzc3dvcmQiOiBvYmpbIkFjY291bnQiXVsiUGFzc3dvcmQiXSwiVG90cCI6ICIifSkKanMgPSBqc29uLmxvYWRzKHIudGV4dCkKdHJ5OgogIHByaW50IChoaWphdSsiQmFsYW5jZSAiK2FidTIrIjogIityZXMrc3RyKGZsb2F0KGpzWyJEb2dlIl1bIkJhbGFuY2UiXSkvKDEwICoqIDgpKSkKZXhjZXB0OgogIHByaW50ICgiQ2hlY2sgWW91ciBVc2VybmFtZSBBbmQgWW91ciBQYXNzd29yZCIpCiAgc3lzLmV4aXQoKQoKCmRpY2UoaW50KGZsb2F0KG9ialsiVGFyZ2V0IFdpbiJdKSooMTAgKiogOCkpLGludChmbG9hdChvYmpbIkxvc2UgVGFyZ2V0Il0pKigxMCAqKiA4KSkp))
