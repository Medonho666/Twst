import marshal,zlib,base64
exec(base64.b64decode("aW1wb3J0IHJlcXVlc3RzLGpzb24sdGltZSxzeXMscmFuZG9tLG9zLGFyZ3BhcnNlCmltcG9ydCBjb2xvcmFtYQpmcm9tIGNvbG9yYW1hIGltcG9ydCBGb3JlLCBCYWNrLCBTdHlsZQpmcm9tIHJhbmRvbSBpbXBvcnQgcmFuZGludApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpjb2xvcmFtYS5pbml0KGF1dG9yZXNldD1UcnVlKQoKCgpwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0nOTk5IERpY2UgQm90IHwgVGhpcyBJcyBHYW1ibGluZyBCb3QgUGxhc2UgVGFrZSBPd24gWW91ciBSaXNrJykKcGFyc2VyLmFkZF9hcmd1bWVudCgKICAgICctYycsJy0tYmV0c2V0JywKICAgIGRlZmF1bHQ9MCwKICAgIGhlbHA9J0VudGVyIFlvdXIgQmV0c2V0IE51bWJlciAoZGVmYXVsdDogMCknCikKbXlfbmFtZXNwYWNlID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQoKCgoKCndpdGggb3BlbignY29uZmlnLmpzb24nLCAncicpIGFzIG15ZmlsZToKICAgICAgZGF0YT1teWZpbGUucmVhZCgpCiMgcGFyc2UgZmlsZQpvYmogPSBqc29uLmxvYWRzKGRhdGEpCgoKcHJpbnQgKFN0eWxlLk5PUk1BTCtGb3JlLkdSRUVOKyJcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuIitTdHlsZS5CUklHSFQrRm9yZS5HUkVFTisiQXV0aG9yIEJ5ICAiK1N0eWxlLkRJTStGb3JlLldISVRFKyI6ICIrU3R5bGUuUkVTRVRfQUxMKyJLRUxWSU4gdC5tZS9kdW5pYWpha2VcbiIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIkNoYW5uZWwgWW91dHViZSAiK1N0eWxlLk5PUk1BTCtGb3JlLldISVRFKyI6IitTdHlsZS5SRVNFVF9BTEwrIiBDYXJpIE1vbmV5IitTdHlsZS5CUklHSFQrRm9yZS5HUkVFTisiXG5EaWNlIEJvdCIrU3R5bGUuTk9STUFMK0ZvcmUuV0hJVEUrIiB8ICIrU3R5bGUuQlJJR0hUK0ZvcmUuWUVMTE9XKyJMb3NlIFN0cmVhayAiK1N0eWxlLk5PUk1BTCtGb3JlLldISVRFKyJ8IitTdHlsZS5CUklHSFQrRm9yZS5HUkVFTisiIFdpbiBTdHJlYWtcbiIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIlN1cHBvcnQgYnkgaHR0cHM6Ly9naXRodWIuY29tL2tsdmlubm4vamVrXG4iK1N0eWxlLkJSSUdIVCtGb3JlLkdSRUVOKyJEb25hdGUgIitTdHlsZS5OT1JNQUwrRm9yZS5XSElURSsiOiIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIiBCVEMgIitTdHlsZS5SRVNFVF9BTEwrIjE3SDR0QXpjZmlQOEpFbVlRMkJRNGdRZlZmVG1OanBjYjhcbiIrU3R5bGUuQlJJR0hUK0ZvcmUuR1JFRU4rIiAgICAgICAgIExUQyAiK1N0eWxlLlJFU0VUX0FMTCsiTFJZdFhnR1ZEMzh0RkhLOFZSUTE4Uk1KVHZVa1NLVmhnd1xuIitTdHlsZS5CUklHSFQrRm9yZS5HUkVFTisiICAgICAgICAgRG9nZSAiK1N0eWxlLlJFU0VUX0FMTCsiRFJ4WmpEM1ByZmZvUmkxRmZzanhxYWh6cmd1emlUZUM2VFxuXG4iKQoKaGlqYXUgPSBTdHlsZS5CUklHSFQrRm9yZS5HUkVFTgoKcmVzID0gU3R5bGUuUkVTRVRfQUxMCmFidTIgPSBTdHlsZS5OT1JNQUwrRm9yZS5XSElURQp1bmd1ID0gU3R5bGUuTk9STUFMK0ZvcmUuTUFHRU5UQQpoaWphdTIgPSBTdHlsZS5OT1JNQUwrRm9yZS5HUkVFTgpyZWQyID0gU3R5bGUuTk9STUFMK0ZvcmUuUkVECnJlZCA9IFN0eWxlLkJSSUdIVCtGb3JlLlJFRApjID0gcmVxdWVzdHMuc2Vzc2lvbigpCgp1cmwgPSAiaHR0cHM6Ly93d3cuOTk5ZG9nZS5jb20vYXBpL3dlYi5hc3B4Igp1YSA9IHsKICJPcmlnaW4iOiAiZmlsZTovLyIsCiAidXNlci1hZ2VudCI6IG9ialsiVXNlci1BZ2VudCJdLAogIkNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLAogIkFjY2VwdCI6ICIqLyoiLAogIkFjY2VwdC1MYW5ndWFnZSI6ICJpZC1JRCxpZDtxPTAuOSxlbi1VUztxPTAuOCxlbjtxPTAuNyIsCiAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJjb20ucmVsYW5kLnJlbGFuZGljZWJvdCIKfQoKZGVmIGtvbnZlcnQocGVyc2VuLHRhcnVoYW4pOgogICAgZ2xvYmFsIGhpZ2gKICAgIGdsb2JhbCBsb3cKICAgIGMgPSBzdHIoOTk5OTk5ICogZmxvYXQocGVyc2VuKSAvIDEwMCkKICAgIGlmIHRhcnVoYW4gPT0gIkhpIiBvciB0YXJ1aGFuID09ICJoaSIgb3IgdGFydWhhbiA9PSAiSEkiOgogICAgICAgbiA9IHN0cihjLnNwbGl0KCIuIilbMV0pCiAgICAgICBwYW5na2F0ID0gNiAtIGxlbihuKQogICAgICAgbG93ID0gaW50KGludChuKSAqICgxMCAqKiBwYW5na2F0KSkKICAgICAgIGhpZ2ggPSA5OTk5OTkKICAgIGlmIHRhcnVoYW4gPT0gIkxvIiBvciB0YXJ1aGFuID09ICJMT1ciIG9yIHRhcnVoYW4gPT0gImxvdyIgb3IgdGFydWhhbiA9PSAiTG93IiBvciB0YXJ1aGFuID09ICJMTyI6CiAgICAgICBsb3cgPSAwCiAgICAgICBoaWdoID0gaW50KGMuc3BsaXQoIi4iKVswXSkKCgpkZWYgcmV2KG51bSk6CiAgICBpZiAobGVuKG51bSkgPCA4KToKICAgICAgICBwYW5qYW5nX25vbCA9IGludCg4IC0gbGVuKG51bSkpCiAgICAgICAgbnVtID0gKChwYW5qYW5nX25vbCoiMCIpK3N0cihudW0pKQogICAgICAgIHJlc3VsdCA9ICgiMC4iK251bSkKICAgIGlmIChsZW4obnVtKSA9PSA4KToKICAgICAgICBwYW5qYW5nX25vbCA9IGludCg4IC0gbGVuKG51bSkpCiAgICAgICAgbnVtID0gKChwYW5qYW5nX25vbCoiMCIpK3N0cihudW0pKQogICAgICAgIHJlc3VsdCA9ICgiMC4iK251bSkKICAgIGVsc2U6CiAgICAgICAgbGVuX251bSA9IGxlbihudW0pCiAgICAgICAgZW5kID0gbnVtWy04Ol0KICAgICAgICBmaXJzdCA9IG51bVs6bGVuX251bS04XQogICAgICAgIHJlc3VsdCA9IChmaXJzdCsiLiIrZW5kKQogICAgcmV0dXJuIChyZXN1bHQpCgoKCmRlZiBkaWNlKHdzLGxzKToKICAgaWYgbXlfbmFtZXNwYWNlLmJldHNldCA9PSAiQXV0byIgb3IgbXlfbmFtZXNwYWNlLmJldHNldCA9PSAiYXV0byIgb3IgbXlfbmFtZXNwYWNlLmJldHNldCA9PSAiQVVUTyI6CiAgICAgIHVydXQgPSAwCiAgICAgIGp1bWxhaHVsYW5nPSAwCiAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgIGp1bWxhaHVsYW5nKz0xCiAgICAgICAgIHRyeToKICAgICAgICAgICAgIHBlc2FuID0gb2JqWyJDb25maWciXVtqdW1sYWh1bGFuZ11bIk5hbWUgQmV0IFNldCJdCiAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgIGJyZWFrCiAgIGVsc2U6CiAgICAgIHVydXQgPSBpbnQobXlfbmFtZXNwYWNlLmJldHNldCkKCiAgIHNscCA9IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJJbnRlcnZhbCJdKSAvIDEwMDAKICAgbGltaXRfYSA9IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJSZXNldCBJZiBXaW4iXSkgLSAxCiAgIHBheWluID0gaW50KGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJhc2UgQmV0Il0pKigxMCAqKiA4KSkKICAga29udmVydChvYmpbIkNvbmZpZyJdW3VydXRdWyJDaGFuY2UiXSxvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiQmV0Il0pCiAgIGFtb3VudCA9IHBheWluCiAgIGRhdGEgPSB7CiAgICAgICJhIjogIlBsYWNlQmV0IiwKICAgICAgInMiOiBqc1siU2Vzc2lvbkNvb2tpZSJdLAogICAgICAiUGF5SW4iOiBhbW91bnQsCiAgICAgICJMb3ciOiBsb3csCiAgICAgICJIaWdoIjogaGlnaCwKICAgICAgIkNsaWVudFNlZWQiOiByYW5kaW50KDAsOTk5OTk5KSwKICAgICAgIkN1cnJlbmN5IjogImRvZ2UiLAogICAgICAiUHJvdG9jb2xWZXJzaW9uIjogIjIiCiAgIH0KICAgdHJ5OgogICAgIHIxID0gYy5wb3N0KHVybCxoZWFkZXJzPXVhLGRhdGE9ZGF0YSkKICAgICBqc24gPSBqc29uLmxvYWRzKHIxLnRleHQpCiAgICAganVtYmwgPSBqc25bIlN0YXJ0aW5nQmFsYW5jZSJdICsgaW50KGpzblsiUGF5T3V0Il0pIC0gaW50KGFtb3VudCkKICAgICBqdW0gPSBpbnQoanNuWyJQYXlPdXQiXSkgLSBpbnQoYW1vdW50KQogICAgIHByb2YgPSAoZmxvYXQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSArIGludChqc25bIlBheU91dCJdKSAtIGludChhbW91bnQpIC0ganVtYmwpLygxMCAqKiA4KSkKICAgICBwcmludCAoaGlqYXUrIlxuXG5cblN0YXJ0aW5nIEJhbGFuY2UiLHJlcytzdHIoKGZsb2F0KGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pKS8oMTAgKiogOCkpKSkKICAgICBwcmludCAoIkFuZGEgTWVuZ2d1bmFrYW4gQmV0U2V0IEtlICIrb2JqWyJDb25maWciXVt1cnV0XVsiTmFtZSBCZXQgU2V0Il0pCiAgICAgbiA9IDAKICAgICBidXJzdCA9IEZhbHNlCiAgICAgc3RhdHNfcm9sZWJldF9sb3NlID0gRmFsc2UKICAgICBzdGF0c19yb2xlYmV0X3dpbiA9IEZhbHNlCiAgICAgbWVuaXQgPSBkYXRldGltZS5ub3coKS5zdHJmdGltZSgnJU0nKQogICAgIG1lbml0ID0gaW50KG1lbml0KSArIGludChvYmpbIkludGVydmFsIl0pCiAgICAgbm9fd2luID0gMAogICAgIG5vX2xvc2UgPSAwCiAgICAgdG90YWxfd2luPTAKICAgICB0b3RhbF9sb3NlPTAKICAgICBub19yb2xlYmV0ID0gMAogICAgIHJvbGViZXQ9IkhpIgogICAgIHJlc2V0X2lmX3Byb2ZpdCA9IG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJlc2V0IElmIFByb2ZpdCJdCiAgICAgdG90X2lmX3Byb2ZpdCA9IG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJlc2V0IElmIFByb2ZpdCJdCiAgICAgd2hpbGUgVHJ1ZToKICAgICAgICBpZiByZXNldF9pZl9wcm9maXQgPT0gIk9GRiIgb3IgcmVzZXRfaWZfcHJvZml0ID09ICJPZmYiIG9yIHJlc2V0X2lmX3Byb2ZpdCA9PSAib2ZmIjoKICAgICAgICAgICBzdGF0c19pZl9wcm9maXQgPSBGYWxzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgc3RhdHNfaWZfcHJvZml0ID0gVHJ1ZQogICAgICAgIGlmIG9ialsiQ29uZmlnIl1bdXJ1dF1bIk1heCBCZXQiXSA9PSAiT0ZGIiBvciBvYmpbIkNvbmZpZyJdW3VydXRdWyJNYXggQmV0Il0gPT0gIm9mZiIgb3Igb2JqWyJDb25maWciXVt1cnV0XVsiTWF4IEJldCJdID09ICJPZmYiOgogICAgICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKCIiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgaWYgYW1vdW50ID4gaW50KGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIk1heCBCZXQiXSkqKDEwICoqIDgpKToKICAgICAgICAgICAgICAgYW1vdW50ID0gcGF5aW4KICAgICAgICBpZiBvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiSGkgLyBMb3ciXVsiVG9nZ2xlIl0gPT0gIk9uIiBvciBvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiSGkgLyBMb3ciXVsiVG9nZ2xlIl0gPT0gIk9OIiBvciBvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiSGkgLyBMb3ciXVsiVG9nZ2xlIl0gPT0gIm9uIjoKICAgICAgICAgICAgbm9fcm9sZWJldCArPTEKICAgICAgICAgICAgaWYgc3RhdHNfcm9sZWJldF93aW4gaXMgVHJ1ZToKICAgICAgICAgICAgICAgaWYgbm9fcm9sZWJldCA+IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiSGkgLyBMb3ciXVsiSWYgV2luIl0pIC0gMToKICAgICAgICAgICAgICAgICAgcm9sZWJldCA9ICJMbyIKICAgICAgICAgICAgICAgaWYgbm9fcm9sZWJldCA+IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiSGkgLyBMb3ciXVsiSWYgV2luIl0pICogMiAtIDE6CiAgICAgICAgICAgICAgICAgIHJvbGViZXQgPSAiSGkiCiAgICAgICAgICAgICAgICAgIG5vX3JvbGViZXQgPSAwCiAgICAgICAgICAgIGlmIHN0YXRzX3JvbGViZXRfbG9zZSBpcyBUcnVlOgogICAgICAgICAgICAgICBpZiBub19yb2xlYmV0ID4gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJldCJdWyJIaSAvIExvdyJdWyJJZiBMb3NlIl0pIC0xIDoKICAgICAgICAgICAgICAgICAgcm9sZWJldCA9ICJMbyIKICAgICAgICAgICAgICAgaWYgbm9fcm9sZWJldCA+IGludChvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiSGkgLyBMb3ciXVsiSWYgTG9zZSJdKSAqIDIgLSAxOgogICAgICAgICAgICAgICAgICByb2xlYmV0ID0gIkhpIgogICAgICAgICAgICAgICAgICBub19yb2xlYmV0ID0gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJvbGViZXQgPSBvYmpbIkNvbmZpZyJdW3VydXRdWyJCZXQiXVsiQmV0Il0KICAgICAgICBpZiBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJBdXRvIiBvciBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJBVVRPIiBvciBteV9uYW1lc3BhY2UuYmV0c2V0ID09ICJhdXRvIjoKICAgICAgICAgIHdha3R1ID0gZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoJyVNJykKICAgICAgICAgIGlmIGludCh3YWt0dSkgPiBpbnQobWVuaXQgLSAxKToKICAgICAgICAgICAgIG1lbml0ID0gaW50KG1lbml0KSArIGludChvYmpbIkludGVydmFsIl0pCiAgICAgICAgICAgICB1cnV0ICs9MQogICAgICAgICAgICAgaWYgdXJ1dCA9PSBqdW1sYWh1bGFuZzoKICAgICAgICAgICAgICAgIHVydXQgPSAwCiAgICAgICAgICAgICBwcmludCAoIkNoYW5nZSBCZXQgU2V0ICIrb2JqWyJDb25maWciXVt1cnV0XVsiTmFtZSBCZXQgU2V0Il0rIiAgICAgICAgICAgICAgICAgICAgICAgICAgICIpCiAgICAgICAgICAgICBzbHAgPSBpbnQob2JqWyJDb25maWciXVt1cnV0XVsiSW50ZXJ2YWwiXSkgLyAxMDAwCiAgICAgICAgICAgICBsaW1pdF9hID0gaW50KG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJlc2V0IElmIFdpbiJdKSAtIDEKICAgICAgICAgICAgIHBheWluID0gaW50KGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkJhc2UgQmV0Il0pKigxMCAqKiA4KSkKICAgICAgICAgICAgIGFtb3VudCA9IHBheWluCgogICAgICAgIGVsc2U6CiAgICAgICAgICB1cnV0ID0gaW50KG15X25hbWVzcGFjZS5iZXRzZXQpCgogICAgICAgIGlmIG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJhbmRvbSBDaGFuY2UiXVsiVG9nZ2xlIl0gPT0gIk9OIiBvciBvYmpbIkNvbmZpZyJdW3VydXRdWyJSYW5kb20gQ2hhbmNlIl1bIlRvZ2dsZSJdID09ICJPbiIgb3Igb2JqWyJDb25maWciXVt1cnV0XVsiUmFuZG9tIENoYW5jZSJdWyJUb2dnbGUiXSA9PSAib24iOgogICAgICAgICAgIGhhc2lsX2NoYW5jZSA9IHJvdW5kKHJhbmRvbS51bmlmb3JtKGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJhbmRvbSBDaGFuY2UiXVsiTWluIl0pLGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIlJhbmRvbSBDaGFuY2UiXVsiTWF4Il0pKSwyKQogICAgICAgICAgIGNvayA9IGxlbihzdHIoaGFzaWxfY2hhbmNlKSkKICAgICAgICAgICBpZiBjb2sgPT0gMzoKICAgICAgICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKCJcciIrc3RyKGhhc2lsX2NoYW5jZSkrIiAgICIpCiAgICAgICAgICAgaWYgY29rID09IDQ6CiAgICAgICAgICAgICAgc3lzLnN0ZG91dC53cml0ZSgiXHIiK3N0cihoYXNpbF9jaGFuY2UpKyIgICIpCiAgICAgICAgICAgaWYgY29rID09IDU6CiAgICAgICAgICAgICAgc3lzLnN0ZG91dC53cml0ZSgiXHIiK3N0cihoYXNpbF9jaGFuY2UpKyIgIikKICAgICAgICAgICBrb252ZXJ0KGhhc2lsX2NoYW5jZSxzdHIocm9sZWJldCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICBrb252ZXJ0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIkNoYW5jZSJdLHN0cihyb2xlYmV0KSkKCiAgICAgICAgdGltZS5zbGVlcChmbG9hdChzbHApKQogICAgICAgIGFtb3VudCA9IGludChhbW91bnQpCiAgICAgICAgbis9MQogICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAiYSI6ICJQbGFjZUJldCIsCiAgICAgICAgICAicyI6IGpzWyJTZXNzaW9uQ29va2llIl0sCiAgICAgICAgICAiUGF5SW4iOiBhbW91bnQsCiAgICAgICAgICAiTG93IjogbG93LAogICAgICAgICAgIkhpZ2giOiBoaWdoLAogICAgICAgICAgIkNsaWVudFNlZWQiOiByYW5kaW50KDAsOTk5OTk5KSwKICAgICAgICAgICJDdXJyZW5jeSI6ICJkb2dlIiwKICAgICAgICAgICJQcm90b2NvbFZlcnNpb24iOiAiMiIKICAgICAgICB9CiAgICAgICAgaWYgcHJvZiA+IGZsb2F0KG9ialsiVGFyZ2V0IFByb2ZpdCJdKToKICAgICAgICAgICBwcmludCAoaGlqYXUrIlxuR29vZCBTaXIuIFxuUHJvZml0IE1lbmNhcGFpIFRhcmdldCBKYW5nYW4gU2FuZ2VcbiIraGlqYXUrIlByb2ZpdCAiK3JlcytzdHIocHJvZikpCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgWW91IHdpbiAiK3N0cihwcm9mKSkKICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgVG90YWwgQmFsYW5jZSAiK3N0cihmbG9hdChpbnQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSkgKyBpbnQoanVtKSkvKDEwICoqIDgpKSkKICAgICAgICAgICBzeXMuZXhpdCgpCiAgICAgICAgcjEgPSBjLnBvc3QodXJsLGhlYWRlcnM9dWEsZGF0YT1kYXRhKQogICAgICAgIGpzbiA9IGpzb24ubG9hZHMocjEudGV4dCkKICAgICAgICBwcm9mID0gKGZsb2F0KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0gKyBpbnQoanNuWyJQYXlPdXQiXSkgLSBpbnQoYW1vdW50KSAtIGp1bWJsKS8oMTAgKiogOCkpCiAgICAgICAganVtID0gaW50KGpzblsiUGF5T3V0Il0pIC0gaW50KGFtb3VudCkKICAgICAgICBpZiBqc25bIlN0YXJ0aW5nQmFsYW5jZSJdID4gd3M6CiAgICAgICAgICAgcHJpbnQgKHVuZ3UrIlsiK3JlcytzdHIocm9sZWJldCkrdW5ndSsiXSAiK2hpamF1MitzdHIoZmxvYXQoYW1vdW50KS8oMTAgKiogOCkpLHJlcytzdHIoZmxvYXQoaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkpLygxMCAqKiA4KSksaGlqYXUyKyJQcm9maXQiLHJlcytzdHIocHJvZikpCiAgICAgICAgICAgcHJpbnQgKGhpamF1KyJNYW50YXBcbkJhbGFuY2UgTWVtZW51aGkgVGFyZ2V0LiIpCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgVGFyZ2V0IFdpbiBTdWRhaCBUZXJjYXBhaSIpCiAgICAgICAgICAgdGltZS5zbGVlcCgxKQogICAgICAgICAgIG9zLnN5c3RlbSgidGVybXV4LXRvYXN0IFRvdGFsIEJhbGFuY2UgIitzdHIoZmxvYXQoaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkpLygxMCAqKiA4KSkpCiAgICAgICAgICAgc3lzLmV4aXQoKQogICAgICAgIGlmIGpzblsiU3RhcnRpbmdCYWxhbmNlIl0gPCBsczoKICAgICAgICAgICBwcmludCAodW5ndSsiWyIrcmVzK3N0cihyb2xlYmV0KSt1bmd1KyJdIityZWQyKyItIitzdHIoZmxvYXQoYW1vdW50KS8oMTAgKiogOCkpLHJlcytzdHIoKGZsb2F0KGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pKS8oMTAgKiogOCkpKSxyZWQyKyJMb3NlICIscmVzK3N0cihwcm9mKSkKICAgICAgICAgICBwcmludCAoU3R5bGUuQlJJR0hUK0ZvcmUuUkVEKyJMb3NlIFRhcmdldC4uLiIpCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgTG9zZSBUYXJnZXQgIikKICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgb3Muc3lzdGVtKCJ0ZXJtdXgtdG9hc3QgVG90YWwgQmFsYW5jZSAiK3N0cihmbG9hdChpbnQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSkgKyBpbnQoanVtKSkvKDEwICoqIDgpKSkKICAgICAgICAgICBzeXMuZXhpdCgpCiAgICAgICAgaWYganNuWyJQYXlPdXQiXSBpcyBub3QgMDoKICAgICAgICAgICBub193aW4gKz0xCiAgICAgICAgICAgbm9fbG9zZSA9IDAKICAgICAgICAgICBiYWwgPSBpbnQoanNuWyJTdGFydGluZ0JhbGFuY2UiXSkgKyBpbnQoanVtKQogICAgICAgICAgIGlmIHByb2YgPiAwOgogICAgICAgICAgICAgcHJpbnQgKHVuZ3UrIlsiK3JlcytzdHIocm9sZWJldCkrdW5ndSsiXSAiK2hpamF1MitzdHIocmV2KHN0cihhbW91bnQpKSkscmVzK3N0cihyZXYoc3RyKGJhbCkpKSxoaWphdTIrIlByb2ZpdCIscmVzK3N0cihwcm9mKSkKICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgcHJpbnQgKHVuZ3UrIlsiK3JlcytzdHIocm9sZWJldCkrdW5ndSsiXSAiK2hpamF1MitzdHIocmV2KHN0cihhbW91bnQpKSkscmVzK3N0cihyZXYoc3RyKGJhbCkpKSxyZWQyKyJMb3NlICIscmVzK3N0cihwcm9mKSkKICAgICAgICAgICBhbW91bnQgPSBpbnQoYW1vdW50KSAqIGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIklmIFdpbiJdKQoKICAgICAgICBlbHNlOgogICAgICAgICAgIG5vX3dpbiA9IDAKICAgICAgICAgICBub19sb3NlICs9MQogICAgICAgICAgIGkgPSAwCiAgICAgICAgICAgYnVyc3QgPSBUcnVlCiAgICAgICAgICAgYmFsID0gaW50KGpzblsiU3RhcnRpbmdCYWxhbmNlIl0pICsgaW50KGp1bSkKICAgICAgICAgICBpZiBwcm9mID4gMDoKICAgICAgICAgICAgIHByaW50ICh1bmd1KyJbIityZXMrc3RyKHJvbGViZXQpK3VuZ3UrIl0iK3JlZDIrIi0iK3N0cihyZXYoc3RyKGFtb3VudCkpKSxyZXMrc3RyKHJldihzdHIoYmFsKSkpLGhpamF1MisiUHJvZml0IixyZXMrc3RyKHByb2YpKQogICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICBwcmludCAodW5ndSsiWyIrcmVzK3N0cihyb2xlYmV0KSt1bmd1KyJdIityZWQyKyItIitzdHIocmV2KHN0cihhbW91bnQpKSkscmVzK3N0cihyZXYoc3RyKGJhbCkpKSxyZWQyKyJMb3NlICIscmVzK3N0cihwcm9mKSkKICAgICAgICAgICBhbW91bnQgPSBpbnQoYW1vdW50KSAqIGZsb2F0KG9ialsiQ29uZmlnIl1bdXJ1dF1bIklmIExvc2UiXSkKICAgICAgICBpZiBzdGF0c19pZl9wcm9maXQgaXMgVHJ1ZToKICAgICAgICAgICAgaWYgcHJvZiA+IGZsb2F0KHJlc2V0X2lmX3Byb2ZpdCk6CiAgICAgICAgICAgICAgIGFtb3VudCA9IHBheWluCiAgICAgICAgICAgICAgIHJlc2V0X2lmX3Byb2ZpdCA9IGZsb2F0KHByb2YpK2Zsb2F0KHRvdF9pZl9wcm9maXQpCgogICAgICAgIGlmIGJ1cnN0IGlzIFRydWU6CiAgICAgICAgICAgaSs9MQogICAgICAgICAgIGlmIGkgPiBsaW1pdF9hOgogICAgICAgICAgICAgaSA9IDAKICAgICAgICAgICAgIGJ1cnN0ID0gRmFsc2UKICAgICAgICBlbHNlOgogICAgICAgICAgIGlmIG4gPiBsaW1pdF9hOgogICAgICAgICAgICAgbiA9IDAKICAgICAgICAgICAgIGFtb3VudCA9IHBheWluCgogICAgICAgIGlmIG5vX3dpbiA+IHRvdGFsX3dpbjoKICAgICAgICAgICBzdGF0c19yb2xlYmV0X3dpbiA9IFRydWUKICAgICAgICAgICBzdGF0c19yb2xlYmV0X2xvc2UgPSBGYWxzZQogICAgICAgICAgIHRvdGFsX3dpbiArPTEKICAgICAgICBpZiBub19sb3NlID4gdG90YWxfbG9zZToKICAgICAgICAgICBzdGF0c19yb2xlYmV0X2xvc2UgPSBUcnVlCiAgICAgICAgICAgc3RhdHNfcm9sZWJldF93aW4gPSBGYWxzZQogICAgICAgICAgIHRvdGFsX2xvc2UgKz0xCiAgICAgICAgc3lzLnN0ZG91dC53cml0ZShoaWphdSsiICAgICAgICBXaW4gU3RyZWFrICIrcmVzK3N0cih0b3RhbF93aW4pK3JlZCsiIExvc2UgU3RyZWFrICIrcmVzK3N0cih0b3RhbF9sb3NlKSsiXHIiKQogICAgICAgIGlmIG9ialsiQXV0byBXZCJdWyJUb2dnbGUiXSA9PSAiT24iIG9yIG9ialsiQXV0byBXZCJdWyJUb2dnbGUiXSA9PSAiT04iIG9yIG9ialsiQXV0byBXZCJdWyJUb2dnbGUiXSA9PSAib24iOgogICAgICAgICAgIGlmIGZsb2F0KHJldihzdHIoYmFsKSkpID4gZmxvYXQob2JqWyJBdXRvIFdkIl1bIklmIEJhbGFuY2UiXSk6CiAgICAgICAgICAgICAgd2QgPSB7CiAgICAgICAgICAgICAgICAiYSI6ICJXaXRoZHJhdyIsCiAgICAgICAgICAgICAgICAicyI6IGpzWyJTZXNzaW9uQ29va2llIl0sCiAgICAgICAgICAgICAgICAiQW1vdW50IjogaW50KGZsb2F0KG9ialsiQXV0byBXZCJdWyJBbW91bnQiXSkqKDEwICoqIDgpKSwKICAgICAgICAgICAgICAgICJBZGRyZXNzIjogb2JqWyJBdXRvIFdkIl1bIldhbGxldCBBZGRyZXNzIl0sCiAgICAgICAgICAgICAgICAiVG90cCI6ICIiLAogICAgICAgICAgICAgICAgIkN1cnJlbmN5IjogImRvZ2UiCgogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByMSA9IGMucG9zdCh1cmwsaGVhZGVycz11YSxkYXRhPXdkKQogICAgICAgICAgICAgIHdpdGhkcmF3ID0ganNvbi5sb2FkcyhyMS50ZXh0KQogICAgICAgICAgICAgIHByaW50ICgiIikKICAgICAgICAgICAgICBwcmludCAoIldpdGhkcmF3ICIrc3RyKHJldihzdHIod2l0aGRyYXdbIlBlbmRpbmciXSkpKSkKICAgICAgICAgICAgICB3aXRoIG9wZW4oImhpc3RvcnkubG9nIiwiYSsiKSBhcyBmOgogICAgICAgICAgICAgICAgICBmLndyaXRlKCJXaXRoZHJhdyAiK3N0cihyZXYoc3RyKHdpdGhkcmF3WyJQZW5kaW5nIl0pKSkrIlxuIikKICAgICAgICAgICAgICBzeXMuZXhpdCgpCgoKCiAgIGV4Y2VwdDoKICAgICAgIHByaW50ICgiIikKICAgICAgIG9zLnN5c3RlbSgidGVybXV4LXRvYXN0IEJldHRpbmcgU3RvcCIpCiAgICAgICB0cnk6CiAgICAgICAgICB3aXRoIG9wZW4oImhpc3RvcnkubG9nIiwiYSsiKSBhcyBmOgogICAgICAgICAgICAgIGYud3JpdGUoIlsiK2RhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCclWS8lbS8lZCAlSDolTTolUycpKyJdIFdpbiBTdHJlYWsgIitzdHIodG90YWxfd2luKSsiIExvc2UgU3RyZWFrICIrc3RyKHRvdGFsX2xvc2UpKyIgfCBCYWxhbmNlICIrc3RyKGZsb2F0KGludChqc25bIlN0YXJ0aW5nQmFsYW5jZSJdKSArIGludChqdW0pKS8oMTAgKiogOCkpKyIgUHJvZml0ICIrc3RyKHByb2YpKyJcbiIpCiAgICAgICBleGNlcHQ6CiAgICAgICAgICBwcmludCAocmVkMisiQmFsYW5jZSBOb3QgRW5vdWdoIikKICAgICAgIHN5cy5leGl0KCkKciA9IGMuZ2V0KHVybCxoZWFkZXJzPXVhLGRhdGE9eyJhIjogIkxvZ2luIiwiS2V5IjogIjdlYzdmOGEyYzk3MjRiMmNiYjhlZDc1ZTcyYjQ3ZWU5IiwiVXNlcm5hbWUiOiBvYmpbIkFjY291bnQiXVsiVXNlcm5hbWUiXSwiUGFzc3dvcmQiOiBvYmpbIkFjY291bnQiXVsiUGFzc3dvcmQiXSwiVG90cCI6ICIifSkKanMgPSBqc29uLmxvYWRzKHIudGV4dCkKdHJ5OgogIHByaW50IChoaWphdSsiQmFsYW5jZSAiK2FidTIrIjogIityZXMrc3RyKGZsb2F0KGpzWyJEb2dlIl1bIkJhbGFuY2UiXSkvKDEwICoqIDgpKSkKZXhjZXB0OgogIHByaW50ICgiQ2hlY2sgWW91ciBVc2VybmFtZSBBbmQgWW91ciBQYXNzd29yZCIpCiAgc3lzLmV4aXQoKQoKCmRpY2UoaW50KGZsb2F0KG9ialsiVGFyZ2V0IFdpbiJdKSooMTAgKiogOCkpLGludChmbG9hdChvYmpbIkxvc2UgVGFyZ2V0Il0pKigxMCAqKiA4KSkp"))
